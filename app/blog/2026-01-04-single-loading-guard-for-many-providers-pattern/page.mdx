# Single Loading Guard for Many Providers Pattern

When your app depends on multiple async providers (Google Maps, session, etc.), use a single `LoadingGuard` to show a loading state until all of them are ready.

## The LoadingGuard

```tsx
// components/templates/LoadingGuard.tsx
'use client';

import { useSession } from 'next-auth/react';
import { useApiLoadingStatus } from '@vis.gl/react-google-maps';

export function LoadingGuard({ children }: { children: React.ReactNode }) {
  const { status: sessionStatus } = useSession();
  const mapsStatus = useApiLoadingStatus();

  const isLoading = sessionStatus === 'loading' || mapsStatus !== 'LOADED';

  if (isLoading) {
    return <LoadingIndicator />;
  }

  return <>{children}</>;
}
```

The guard checks both `SessionProvider` and `APIProvider` loading states. Children only render when everything is ready.

## Usage in Layout

Place the guard inside the providers it checks:

```tsx
// app/layout.tsx
'use client';

import { SessionProvider } from 'next-auth/react';
import { APIProvider } from '@vis.gl/react-google-maps';
import { LoadingGuard } from 'components/templates/LoadingGuard';

export default function Layout({ children }) {
  return (
    <APIProvider apiKey={process.env.NEXT_PUBLIC_GOOGLE_MAPS_API_KEY!}>
      <SessionProvider>
        <LoadingGuard>{children}</LoadingGuard>
      </SessionProvider>
    </APIProvider>
  );
}
```

The guard must be inside `APIProvider` and `SessionProvider` to access their hooks.
